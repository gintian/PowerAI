<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=muqxIubVMYH11GIOLp6nGTqm2QEZTqBy"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
		ul,li{list-style: none;margin:0;padding:0;float:left;}
		html{height:100%}
		body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
		#container{height:500px;width:100%;}
		#r-result{width:100%;}
    </style>	
</head>
<body>
	<div id="container"></div>
	<div id="r-result">
		<input type="button"  onclick="openHeatmap();" value="show heat map"/><input type="button"  onclick="closeHeatmap();" value="close heat map"/>
	</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例

    var point = new BMap.Point(113.418261, 33.921984);
    map.centerAndZoom(point, 5);             // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放
  
    var points =[
	{"lng":121.302632,"lat":43.622878,"count":710.345685},
	{"lng":121.436542,"lat":44.987676,"count":677.405059},
	{"lng":118.350430,"lat":42.793796,"count":789.749950},
	{"lng":123.037000,"lat":44.153377,"count":743.830681},
	{"lng":122.572550,"lat":46.268946,"count":742.927452},
	{"lng":119.268169,"lat":42.184131,"count":724.400043},
	{"lng":116.795172,"lat":43.065594,"count":724.612200},
	{"lng":120.949421,"lat":44.275303,"count":743.023217},
	{"lng":118.898489,"lat":42.260361,"count":744.910091},
	{"lng":122.233664,"lat":43.371961,"count":744.078457},
	{"lng":121.261340,"lat":44.020139,"count":760.325670},
	{"lng":116.628012,"lat":42.684054,"count":743.662536},
	{"lng":121.371114,"lat":46.498876,"count":777.880251},
	{"lng":119.843897,"lat":49.267944,"count":465.602383},
	{"lng":121.009091,"lat":43.282674,"count":732.084394},
	{"lng":123.342371,"lat":43.676121,"count":743.666530},
	{"lng":119.961072,"lat":44.387352,"count":771.310687},
	{"lng":118.246907,"lat":42.630319,"count":743.681416},
	{"lng":118.659909,"lat":43.530698,"count":772.678643},
	{"lng":124.707052,"lat":40.346319,"count":782.955825},
	{"lng":119.075244,"lat":42.330795,"count":679.665864},
	{"lng":121.399574,"lat":43.779260,"count":743.714839},
	{"lng":121.956600,"lat":42.845098,"count":838.994384},
	{"lng":115.488323,"lat":43.351048,"count":756.234586},
	{"lng":119.836749,"lat":49.263201,"count":772.920668},
	{"lng":122.241323,"lat":42.865682,"count":668.231785},
	{"lng":118.461556,"lat":44.777363,"count":717.905343},
	{"lng":122.305962,"lat":43.630136,"count":789.288551},
	{"lng":119.363884,"lat":44.009072,"count":774.190009},
	{"lng":120.026302,"lat":40.305129,"count":732.554853},
	{"lng":118.830549,"lat":43.575552,"count":736.410975},
	{"lng":118.930599,"lat":42.334397,"count":755.819678},
	{"lng":121.922580,"lat":43.589756,"count":746.480763},
	{"lng":124.689242,"lat":40.459444,"count":624.992624},
	{"lng":121.572298,"lat":43.337750,"count":668.809175},
	{"lng":117.642808,"lat":44.568764,"count":779.723883},
	{"lng":118.966165,"lat":42.262756,"count":711.375654},
	{"lng":119.260631,"lat":42.279963,"count":739.761502},
	{"lng":122.279269,"lat":43.611211,"count":751.545340},
	{"lng":119.760111,"lat":49.154739,"count":587.903664},
	{"lng":122.019128,"lat":46.078120,"count":717.538625},
	{"lng":122.991934,"lat":41.091273,"count":682.691038},
	{"lng":119.666036,"lat":45.537200,"count":743.685007},
	{"lng":119.652480,"lat":45.522235,"count":781.293094},
	{"lng":116.094619,"lat":43.941284,"count":703.644812},
	{"lng":122.392895,"lat":46.348715,"count":778.472841},
	{"lng":121.830750,"lat":44.893718,"count":702.847362},
	{"lng":119.833578,"lat":42.733717,"count":739.257812},
	{"lng":118.951439,"lat":42.311299,"count":740.718216},
	{"lng":125.383973,"lat":45.129789,"count":737.619251},
	{"lng":126.541162,"lat":43.814725,"count":734.736164},
	{"lng":126.698202,"lat":43.654515,"count":727.350801},
	{"lng":125.968827,"lat":44.194372,"count":869.587630},
	{"lng":126.156280,"lat":41.772626,"count":732.105747},
	{"lng":126.529194,"lat":43.837430,"count":717.870712},
	{"lng":126.535864,"lat":43.838856,"count":761.645973},
	{"lng":123.443074,"lat":44.493516,"count":709.527731},
	{"lng":127.165482,"lat":42.343004,"count":712.315500},
	{"lng":123.708520,"lat":43.767695,"count":737.922621},
	{"lng":126.564544,"lat":43.871988,"count":713.804483},
	{"lng":126.579656,"lat":43.906264,"count":746.263877},
	{"lng":124.391382,"lat":43.175525,"count":741.100848},
	{"lng":122.330666,"lat":44.604179,"count":765.500873},
	{"lng":126.565019,"lat":42.856481,"count":696.104407},
	{"lng":124.436630,"lat":43.089848,"count":750.858188},
	{"lng":129.471301,"lat":43.059667,"count":714.696229},
	{"lng":126.535864,"lat":43.838856,"count":735.117296},
	{"lng":126.543978,"lat":43.829860,"count":750.872831},
	{"lng":126.630186,"lat":43.839229,"count":739.142895},
	{"lng":126.574176,"lat":43.834165,"count":724.276781},
	{"lng":126.396643,"lat":41.791642,"count":743.684679},
	{"lng":130.702367,"lat":43.074719,"count":717.725158},
	{"lng":129.005313,"lat":42.563374,"count":726.965845},
	{"lng":122.840777,"lat":45.621086,"count":704.862580},
	{"lng":126.435798,"lat":41.945859,"count":747.183091},
	{"lng":127.056399,"lat":42.991653,"count":732.728407},
	{"lng":125.133686,"lat":42.923303,"count":722.583324},
	{"lng":126.069684,"lat":42.916297,"count":735.536069},
	{"lng":125.313642,"lat":43.898338,"count":722.855330},
	{"lng":125.313642,"lat":43.898338,"count":740.486935},
	{"lng":125.313642,"lat":43.898338,"count":750.847886},
	{"lng":125.313642,"lat":43.898338,"count":725.036263},
	{"lng":126.479857,"lat":44.521726,"count":748.654187},
	{"lng":124.338543,"lat":40.129023,"count":733.698487},
	{"lng":124.338543,"lat":40.129023,"count":736.840338},
	{"lng":122.000169,"lat":40.191425,"count":743.669301},
	{"lng":121.285575,"lat":41.152566,"count":765.045941},
	{"lng":120.461474,"lat":41.566709,"count":740.282416},
	{"lng":120.664645,"lat":41.137036,"count":728.428721},
	{"lng":124.717527,"lat":40.699301,"count":743.676633},
	{"lng":122.935260,"lat":41.732935,"count":746.244729},
	{"lng":122.691903,"lat":39.243906,"count":773.648351},
	{"lng":121.976776,"lat":39.399424,"count":739.870220},
	{"lng":121.290021,"lat":41.533877,"count":743.679702},
	{"lng":121.648523,"lat":38.962567,"count":812.449366},
	{"lng":121.648523,"lat":38.962567,"count":723.077610},
	{"lng":125.171491,"lat":40.878947,"count":700.605023},
	{"lng":122.934145,"lat":39.858910,"count":947.497904},
	{"lng":123.064608,"lat":42.693946,"count":761.069238},
	{"lng":122.502418,"lat":42.141551,"count":741.251722},
	{"lng":123.904050,"lat":41.881110,"count":788.500309},
	{"lng":123.929820,"lat":41.877304,"count":746.239305},
	{"lng":123.946409,"lat":43.000462,"count":731.237292},
	{"lng":120.488982,"lat":41.609868,"count":743.718296},
	{"lng":123.778062,"lat":41.325838,"count":744.298130},
	{"lng":125.290028,"lat":41.261816,"count":732.504082},
	{"lng":123.504363,"lat":41.821255,"count":751.889288},
	{"lng":123.244949,"lat":41.798272,"count":754.152894},
	{"lng":122.364757,"lat":39.778648,"count":753.199846},
	{"lng":124.275780,"lat":42.508557,"count":733.343929},
	{"lng":120.336360,"lat":41.518421,"count":799.422652},
	{"lng":122.079152,"lat":41.984761,"count":733.717263},
	{"lng":121.528500,"lat":38.955462,"count":726.321548},
	{"lng":122.073228,"lat":41.141248,"count":740.495920},
	{"lng":121.574238,"lat":39.767219,"count":759.580006},
	{"lng":123.227645,"lat":41.363448,"count":733.824313},
	{"lng":123.496911,"lat":41.867944,"count":748.466551},
	{"lng":124.102909,"lat":41.932564,"count":743.714213},
	{"lng":123.426289,"lat":41.589345,"count":745.384544},
	{"lng":122.233391,"lat":40.668651,"count":345.206629},
	{"lng":122.233391,"lat":40.668651,"count":749.474913},
	{"lng":123.584348,"lat":42.442930,"count":704.217702},
	{"lng":123.421287,"lat":41.779620,"count":732.524186},
	{"lng":122.554004,"lat":39.576203,"count":722.810328},
	{"lng":121.986995,"lat":39.408202,"count":733.383447},
	{"lng":123.854850,"lat":42.299757,"count":749.049286},
	{"lng":121.147749,"lat":41.130879,"count":749.696672},
	{"lng":121.147749,"lat":41.130879,"count":740.501165},
	{"lng":121.147749,"lat":41.130879,"count":751.706958},
	{"lng":122.130706,"lat":41.870719,"count":757.979512},
	{"lng":123.296707,"lat":40.279924,"count":749.636213},
	{"lng":121.660822,"lat":42.019250,"count":753.910899},
	{"lng":121.751500,"lat":41.946876,"count":736.281395},
	{"lng":121.660822,"lat":42.019250,"count":749.723256},
	{"lng":121.660822,"lat":42.019250,"count":718.423188},
	{"lng":123.007763,"lat":41.118744,"count":721.994981},
	{"lng":122.936257,"lat":41.153031,"count":743.679702},
	{"lng":120.625837,"lat":41.583791,"count":762.577653},
	{"lng":121.303001,"lat":38.849472,"count":743.656552},
	{"lng":131.019048,"lat":45.775005,"count":743.863404},
	{"lng":126.664073,"lat":45.726736,"count":739.882688},
	{"lng":128.900580,"lat":47.741959,"count":741.001725},
	{"lng":130.284735,"lat":46.813780,"count":704.050660},
	{"lng":132.414750,"lat":45.234264,"count":747.823656},
	{"lng":126.818061,"lat":45.739872,"count":707.319856},
	{"lng":131.171402,"lat":46.655102,"count":738.527685},
	{"lng":131.171402,"lat":46.655102,"count":764.001131},
	{"lng":126.579604,"lat":45.925777,"count":753.023297},
	{"lng":128.622721,"lat":47.744068,"count":718.923092},
	{"lng":126.705452,"lat":45.786599,"count":695.895582},
	{"lng":126.266360,"lat":46.226700,"count":728.471309},
	{"lng":126.609533,"lat":45.753329,"count":732.636005},
	{"lng":126.666278,"lat":45.644424,"count":691.626042},
	{"lng":126.698009,"lat":45.714725,"count":746.649047},
	{"lng":127.591919,"lat":45.577180,"count":725.327075},
	{"lng":125.021840,"lat":46.596709,"count":729.826232},
	{"lng":129.829661,"lat":46.256111,"count":738.705337},
	{"lng":131.160554,"lat":46.694278,"count":718.473285},
	{"lng":129.827939,"lat":46.487071,"count":735.433280},
	{"lng":129.604038,"lat":44.580070,"count":681.198508},
	{"lng":123.633372,"lat":47.220163,"count":733.267208},
	{"lng":123.633372,"lat":47.220163,"count":595.149457},
	{"lng":124.511244,"lat":48.484677,"count":744.120076},
	{"lng":124.602272,"lat":46.745140,"count":743.679722},
	{"lng":126.840306,"lat":45.624483,"count":739.399582},
	{"lng":126.679488,"lat":45.745088,"count":743.652999},
	{"lng":129.616707,"lat":44.543619,"count":725.556831},
	{"lng":129.621775,"lat":44.567526,"count":749.227434},
	{"lng":131.886750,"lat":45.555026,"count":728.948474},
	{"lng":123.999074,"lat":47.368017,"count":743.682742},
	{"lng":124.543521,"lat":46.493478,"count":743.682086},
	{"lng":126.801953,"lat":46.346219,"count":740.158215},
	{"lng":126.982721,"lat":46.639126,"count":731.760025},
	{"lng":126.578635,"lat":45.724506,"count":756.423831},
	{"lng":129.027104,"lat":44.010419,"count":733.442748},
	{"lng":130.794693,"lat":46.245896,"count":754.514913},
	{"lng":130.941767,"lat":45.321540,"count":754.867703},
	{"lng":130.941767,"lat":45.321540,"count":741.483033},
	{"lng":130.292472,"lat":47.338666,"count":751.348287},
	{"lng":130.292472,"lat":47.338666,"count":714.412391},
	{"lng":124.066419,"lat":47.377812,"count":744.995445}];
	   
    if(!isSupportCanvas()){
    	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
	//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
	//参数说明如下:
	/* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小   
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *	{
			.2:'rgb(0, 255, 255)',
			.5:'rgb(0, 110, 255)',
			.8:'rgb(100, 0, 255)'
		}
		其中 key 表示插值的位置, 0~1. 
		    value 为颜色值. 
     */
	heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":20});
	map.addOverlay(heatmapOverlay);
	heatmapOverlay.setDataSet({data:points,max:1000}); //只需要调节max中的值就可以，也就是最高电压等级，越接近这个值就越红，越不接近越蓝
	//是否显示热力图
    function openHeatmap(){
        heatmapOverlay.show();
    }
	function closeHeatmap(){
        heatmapOverlay.hide();
    }
	closeHeatmap();
    function setGradient(){
     	/*格式如下所示:
		{
	  		0:'rgb(102, 255, 0)',
	 	 	.5:'rgb(255, 170, 0)',
		  	1:'rgb(255, 0, 0)'
		}*/
     	var gradient = {};
     	var colors = document.querySelectorAll("input[type='color']");
     	colors = [].slice.call(colors,0);
     	colors.forEach(function(ele){
			gradient[ele.getAttribute("data-key")] = ele.value; 
     	});
        heatmapOverlay.setOptions({"gradient":gradient});
    }
	//判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>
